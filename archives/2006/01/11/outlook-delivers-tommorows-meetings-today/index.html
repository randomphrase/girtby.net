<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>girtby.net &#8211;   Outlook Delivers Tommorow&#8217;s Meetings Today</title>

<meta name="verify-v1" content="unGvQ7Jwj5liZb2PzH2ckduvpe8Ua3Ls0MONzCHQQn4=" />

<link rel="stylesheet" href="http://girtby.net/wp-content/themes/depo-clean/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Articles Feed" href="http://girtby.net/feed/atom/" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Comments Feed" href="http://girtby.net/comments/feed/atom/" />

<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://arankine.myopenid.com/" />

<link rel="meta" href="http://girtby.net/labels.rdf" type="application/rdf+xml" title="ICRA labels" />
<meta http-equiv="pics-Label" content='(pics-1.1 "http://www.icra.org/pics/vocabularyv03/" l gen true for "http://girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1) gen true for "http://www.girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1))' />

<link rel="prev" href="http://girtby.net/archives/2006/01/10/windows-for-smarties/" />
<link rel="next" href="http://girtby.net/archives/2006/01/12/working-the-numbers/" />

<link rel="pingback" href="http://girtby.net/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Feed" href="http://girtby.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Comments Feed" href="http://girtby.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Outlook Delivers Tommorow&#8217;s Meetings Today Comments Feed" href="http://girtby.net/archives/2006/01/11/outlook-delivers-tommorows-meetings-today/feed/" />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'></script>
<script type='text/javascript' src='http://girtby.net/wp-content/themes/depo-clean/javascript/friendly_dates.js?ver=2.9-rare'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://girtby.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://girtby.net/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='girtby.net' href='http://girtby.net' />
<link rel='start' title='Thunderbirds Are Go-ne' href='http://girtby.net/archives/2004/09/20/thunderbirds-are-go-ne/' />
<link rel='prev' title='Windows For Smarties' href='http://girtby.net/archives/2006/01/10/windows-for-smarties/' />
<link rel='next' title='Working The Numbers' href='http://girtby.net/archives/2006/01/12/working-the-numbers/' />
<meta name="generator" content="WordPress 2.9-rare" />
<link rel='canonical' href='http://girtby.net/archives/2006/01/11/outlook-delivers-tommorows-meetings-today/' />
			<script type="text/javascript" src="http://girtby.net/wp-content/plugins/flickr-tag/js/flickrTagTooltips.js"></script>

			<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTagTooltips.css" type="text/css" rel="stylesheet"/>
	
		<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTag.css" type="text/css" rel="stylesheet"/>
	</head>
<body>
<div class="container">
	<div class="header">
        <div class="search">
            <form method="get" id="sform" action="http://girtby.net/">
                <input type="text" id="q" value="" name="s" size="15" />
			</form>
        </div><!-- end search -->
        			        <h1><a href="http://girtby.net/">this blog is girtby.net</a> 
            </h1>
	</div><!-- end header -->


<div class="blogads">

<!-- Your Stuff Here -->

</div>


    						
      <div class="post">
          <div class="metainfo">
              <p>Posted<br />
                <abbr class="published" title="Wed, 11 Jan 2006 22:01:30 -0500">11 January 2006 @ 10pm</abbr></p>
                <p>Tagged<br />
                <a href="http://girtby.net/archives/category/nerd-factor-x/" title="View all posts in Nerd Factor X" rel="category tag">Nerd Factor X</a></p>
                		    </div>
		    <div class="content">
		        <h3>Outlook Delivers Tommorow&#8217;s Meetings Today 
		        </h3>
		        <p>For a long time now I have encountered a really frustrating problem with Outlook calendars. This is an attempt to explain what the problem is, and why it happens. There is no fix or workaround, but maybe you have some ideas?</p>

<p>Lets say you work in Melbourne and you have a colleage based in Atlanta. You collaborate closely on a project so you want to schedule a regular meeting to discuss it. You both use Microsoft Outlook to manage your calendars.</p>

<p><span id="more-166"></span></p>

<p>Your colleage creates a meeting for Monday 4pm <abbr title="Eastern Standard Time (US)">EST</abbr>. This is Tuesday 8am <abbr title="Australian Eastern Daylight Time">AEDT</abbr>.</p>

<p><img src="/images/appointment-startend.png" width="418" height="231" alt="Screenshot showing the start and end time of the meeting in the US time zone." class="centered"/></p>

<p>Your colleage hits the recurrence button, and chooses to have the meeting recur every week on Monday.</p>

<p><img src="/images/appointment-recur.png" width="468" height="351" alt="Screenshot showing the recurrence dialog box with weekly recurrence selected" class="centered"/></p>

<p>You get the meeting invite and hit Accept. It goes into your calendar this Tuesday at 8am, and all subsequent Tuesdays at the same time. No problems.</p>

<p>Now here&#8217;s where the fun starts. You synchronise your calendar using Outlook&#8217;s OLE interface to some other device, such as your PalmOS PDA. This is an example only &#8211; as we&#8217;ll see the problem seems to be a limitation of the OLE interface and so exists for other devices and other Outlook synchronisation software.</p>

<p>Upon synchronising your PDA, you find out that the first appointment is present at the correct time (Tuesday 8am), but all subsequent instances occur on <em>Monday</em> at 8am. As a result you&#8217;re on time for your first meeting but a day early for all subsequent meetings!</p>

<p>In order to see exactly what&#8217;s going on, lets use a little bit of scripting to interrogate the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vbaol11/html/oltocommap_HV01049998.asp">Outlook Object Model</a>. The following is a JavaScript that uses the Outlook OLE interface. You can follow along at home using the windows scripting host; just save the following to a file, then run it using <code>cscript</code>.</p>

<pre><code>var ol = new ActiveXObject("outlook.application");
// olFolderCalendar = 9
var calendar = ol.getnamespace("mapi").getdefaultfolder(9).items;
var stdout = WScript.StdOut;
var i = 1;
var total = calendar.Count;

for (i=1; i&lt;=total; i++) {

    var item = calendar(i);

    if (!item.isrecurring)
        continue;

    var pattern = item.getrecurrencepattern;
    var patternType = pattern.recurrencetype;

    // olRecursWeekly = 1
    if (patternType != 1)
        continue;

    stdout.WriteLine("Weekly recurring event: " + item.subject);
    stdout.WriteLine("   start: " + new Date(item.start));
    stdout.WriteLine("   end:   " + new Date(item.end));

    var mask = pattern.dayofweekmask;
    var daysOfWeek = "";

    if (mask &amp; 1)  { daysOfWeek = "Sunday"; }
    if (mask &amp; 2)  { daysOfWeek += " Monday"; }
    if (mask &amp; 4)  { daysOfWeek += " Tuesday"; }
    if (mask &amp; <img src='http://girtby.net/wp-includes/images/smilies/icon_cool.gif' alt='8)' class='wp-smiley' />  { daysOfWeek += " Wednesday"; }
    if (mask &amp; 16) { daysOfWeek += " Thursday"; }
    if (mask &amp; 32) { daysOfWeek += " Friday"; }
    if (mask &amp; 64) { daysOfWeek += " Saturday"; }

    stdout.WriteLine("   recurs on: " + daysOfWeek);
}
</code></pre>

<p>If all goes well you should see a dump of your weekly recurring events in Outlook. Here&#8217;s what you should see when you run the above script to show the project meeting appointment that was initiated by your American colleage:</p>

<pre><code>Weekly recurring event: Project Meeting
   start: Tue Jan 17 08:00:00 UTC+1100 2005
   end:   Tue Jan 17 09:00:00 UTC+1100 2005
   recurs on:  Monday
</code></pre>

<p>So Outlook is translating the start and end time into the local (Melbourne) time zone, but it does <em>not</em> translate the days of recursion. The appointment should recur every Tuesday (in local time), as it does in the Outlook GUI, but instead it recurs on Mondays.</p>

<p>You could almost argue that this is not a bug, if it were possible to get the originating time zone of the appointment. This would allow you to do the day translation yourself. But as far as I can tell from looking at the object model, this is <em>not</em> possible. You can get the start and end time as a <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnvbadev/html/whatisdatehowdiditgetthere.asp">Date object</a>, which as far as I can tell does not contain a time zone.</p>

<p>Unless I&#8217;m missing something in the Outlook object model, there&#8217;s definitely a bug here: either the incorrect value is returned, or the information which allows the correct value to be calculated is missing.</p>

<p>So it seems that there is no way to fix or work around this problem using the Outlook OLE interface. Which is a requirement because it seems to be the most common interface used by synchronisation software.</p>

<p>Any ideas?</p>
		        <br clear="left" />
		    </div>
        </div><!-- end post -->

			
<!-- You can start editing here. -->


<div id="comments" class="post">

	<h3 class="comments_headers">1 Comment</h3>

</div>
	
	
			
        <div class="post" id="comment-1334">
		    <div class="metainfo">
                <p>Posted by<br />alastair<br />
                <input type="hidden" name="post_date" value="Wed, 11 Jan 2006 22:01:30 -0500" />
                <abbr class="commented" title="Wed, 11 Jan 2006 22:01:30 -0500">11 January 2006 @ 10pm</abbr><br />
                <a href="#comment-1334">#</a></p>
			</div>
			<div class="content">
				<p>I emailed Matt Stehle about this problem. Matt is a support engineer for Microsoft, focusing on Messaging APIs. He also runs the excellent <a href="http://blogs.msdn.com/mstehle/" rel="nofollow">CDOs and CDONTS of Messaging Development</a> blog. He replied with the following:</p>

<blockquote>Happy to help.  I don&#8217;t have any information off hand but I did show it
to one of our Outlook development experts.  He thinks this might be
address in Office 12 but we&#8217;ll check to see if this was bugged for
Office 2003.  I&#8217;ll let you know if we find anything.

Thanks for reading!</blockquote>

<p>Thanks in advance Matt!</p> 
							</div>
		<br clear="left" />
		</div>
		
	

	<!-- Comment Form -->

	    

			
				
<div class="posttopline">
	<span class="previous">&larr; <a href="http://girtby.net/archives/2006/01/10/windows-for-smarties/" rel="prev">Windows For Smarties</a></span>
	<span class="next"><a href="http://girtby.net/archives/2006/01/12/working-the-numbers/" rel="next">Working The Numbers</a> &rarr;</span>
</div>

<br clear="all" />

    <div class="footer">
		
        <div class="first">
        <div id="text-318154731" class="widget widget_text"><h5 class="widgettitle">Archives</h5>			<div class="textwidget"><ul>
<li><a href="/archives/2009">2009</a></li>
<li><a href="/archives/2008">2008</a></li>
<li><a href="/archives/2007">2007</a></li>
<li><a href="/archives/2006">2006</a></li>
<li><a href="/archives/2005">2005</a></li>
<li><a href="/archives/2004">2004</a></li>
</ul></div>
		</div>		</div>

        <div class="sidebar">
        <div id="text-326846052" class="widget widget_text"><h5 class="widgettitle">Leveraged Synergy</h5>			<div class="textwidget"><p>Hello, I&#8217;m Alastair Rankine. I once had a blog, and you've found it. <a href="/about/">Would you like to know more?</a></p>
<p>From time to time I made offerings to the internet. <a href="/offerings/">Would you like some?</a></p>
</div>
		</div>        </div>

        <div class="last">
        <div id="linkcat-2" class="widget widget_links"><h5 class="widgettitle">Blogroll</h5>
	<ul class='xoxo blogroll'>
<li><a href="http://bjkeefe.blogspot.com">bjkeefe</a></li>
<li><a href="http://brainsnorkel.com">brainsnorkel</a></li>
<li><a href="http://deadlybloodyserious.com">Deadly Bloody Serious</a></li>
<li><a href="http://blog.alphajuliet.com/">follicle</a></li>
<li><a href="http://madbean.com/">madbean</a></li>
<li><a href="http://marxyblog.blogspot.com">marxy&#8217;s musing on technology</a></li>
<li><a href="http://mattrubinstein.com.au">mattrubinstein.com.au</a></li>
<li><a href="http://somethinkodd.com/oddthinking">OddThinking</a></li>

	</ul>
</div>
        </div>

	    </div><!-- end footer -->

        <br clear="all" />
        
		<div class="copyright">
        	        	<span class="previous">&larr; <a href="http://girtby.net">Back to Home</a></span>
                        <p>Powered by <a href="http://wordpress.org">WordPress</a> using the <a href="http://powazek.com/posts/516">DePo Clean Theme</a> <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/au/"><img alt="Creative Commons License" class="badge" width=80 height=15 src="http://i.creativecommons.org/l/by-sa/2.5/au/80x15.png" /></a></p>
            		</div>

	</div> <!-- end container -->
</body>
</html>
