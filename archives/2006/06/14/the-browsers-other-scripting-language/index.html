<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>girtby.net &#8211;   The Browser&#8217;s Other Scripting Language</title>

<meta name="verify-v1" content="unGvQ7Jwj5liZb2PzH2ckduvpe8Ua3Ls0MONzCHQQn4=" />

<link rel="stylesheet" href="http://girtby.net/wp-content/themes/depo-clean/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Articles Feed" href="http://girtby.net/feed/atom/" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Comments Feed" href="http://girtby.net/comments/feed/atom/" />

<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://arankine.myopenid.com/" />

<link rel="meta" href="http://girtby.net/labels.rdf" type="application/rdf+xml" title="ICRA labels" />
<meta http-equiv="pics-Label" content='(pics-1.1 "http://www.icra.org/pics/vocabularyv03/" l gen true for "http://girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1) gen true for "http://www.girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1))' />

<link rel="prev" href="http://girtby.net/archives/2006/06/06/creative-uncommon/" />
<link rel="next" href="http://girtby.net/archives/2006/06/24/bad-company/" />

<link rel="pingback" href="http://girtby.net/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Feed" href="http://girtby.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Comments Feed" href="http://girtby.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; The Browser&#8217;s Other Scripting Language Comments Feed" href="http://girtby.net/archives/2006/06/14/the-browsers-other-scripting-language/feed/" />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'></script>
<script type='text/javascript' src='http://girtby.net/wp-content/themes/depo-clean/javascript/friendly_dates.js?ver=2.9-rare'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://girtby.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://girtby.net/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='girtby.net' href='http://girtby.net' />
<link rel='start' title='Thunderbirds Are Go-ne' href='http://girtby.net/archives/2004/09/20/thunderbirds-are-go-ne/' />
<link rel='prev' title='Creative, Uncommon' href='http://girtby.net/archives/2006/06/06/creative-uncommon/' />
<link rel='next' title='Bad Company' href='http://girtby.net/archives/2006/06/24/bad-company/' />
<meta name="generator" content="WordPress 2.9-rare" />
<link rel='canonical' href='http://girtby.net/archives/2006/06/14/the-browsers-other-scripting-language/' />
			<script type="text/javascript" src="http://girtby.net/wp-content/plugins/flickr-tag/js/flickrTagTooltips.js"></script>

			<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTagTooltips.css" type="text/css" rel="stylesheet"/>
	
		<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTag.css" type="text/css" rel="stylesheet"/>
	</head>
<body>
<div class="container">
	<div class="header">
        <div class="search">
            <form method="get" id="sform" action="http://girtby.net/">
                <input type="text" id="q" value="" name="s" size="15" />
			</form>
        </div><!-- end search -->
        			        <h1><a href="http://girtby.net/">this blog is girtby.net</a> 
            </h1>
	</div><!-- end header -->


<div class="blogads">

<!-- Your Stuff Here -->

</div>


    						
      <div class="post">
          <div class="metainfo">
              <p>Posted<br />
                <abbr class="published" title="Wed, 14 Jun 2006 00:53:00 -0400">14 June 2006 @ 12am</abbr></p>
                <p>Tagged<br />
                <a href="http://girtby.net/archives/category/nerd-factor-x/" title="View all posts in Nerd Factor X" rel="category tag">Nerd Factor X</a></p>
                		    </div>
		    <div class="content">
		        <h3>The Browser&#8217;s Other Scripting Language 
		        </h3>
		        <p>You&#8217;d think that with all the excitement about AJAX and other new client-side (that is, browser-side) architectural focus that there would be a bit more lovin&#8217; for the other  browser-side scripting language besides JavaScript. But despite being <a href="http://www.unidex.com/turing/utm.htm">turing-complete</a> XSLT isn&#8217;t as widely talked about as its more glamourous sibling.</p>

<p>Herewith some observations on the current sorry state of XSLT in the browser, which may point to the reasons for its neglect.</p>

<p><span id="more-194"></span></p>

<h4>Tree, Transform Thyself</h4>

<p>XSLT is a language for transforming trees of input XML nodes into output trees. It is designed to allow templates to be constructed which are matched against patterns in the input tree. When a match occurs, the template is used to construct the relevant output tree. There&#8217;s more to it than that, but at its heart XSLT is all about transformation of XML trees.</p>

<p><img src="/images/xslt.png" height="369" width="526" alt="Diagram showing an XML tree being transformed" class="centered" /></p>

<p>When you first attempt to use XSLT it can be quite intimidating. The syntax itself is all XML and that introduces some complexity of its own, although it provides a perfectly natural way of specifying output tree templates. It takes some time to get your head around the fact that you&#8217;re not specifying <em>how</em> the transform happens. Instead you get the best out of XSLT by specifying the <em>mapping</em> of outputs to inputs. XSLT has a lot in common with functional programming in this respect and others.</p>

<p>When it works well, XSLT is <a href="/archives/2005/12/08/pimp-my-xslt/">almost elegant</a> (if I do say so myself). When it doesn&#8217;t it can be downright byzantine, but let&#8217;s not get ahead of ourselves.</p>

<p>Nonetheless I think the basic idea is pretty powerful. It also happens to fit in really nicely with the REST architectural style (at least as I understand it) and so is very web-friendly. Browser accesses the raw XML of a resource and locally transforms it to an HTML representation. It is even backwards compatible with Web 1.0.</p>

<h4>When Good Transforms Go Bad</h4>

<p>Sometimes XSLT can be very frustrating. Sooner or later you run into one of the many gotchas. For example, there is no way to group a given set of XML nodes (eg to find the unique nodes) and this requires a <a href="http://www.jenitennison.com/xslt/grouping/">hack</a> to work around.</p>

<p>Another hack which is sometimes required is the use of the <code>node-set</code> extension function (or equivalent, sometimes known as <code>nodeset</code>). This is a bit technical but it basically allows the use of intermediate results.</p>

<p>In XSLT 1.0 there is a thing called a Result Tree Fragment. This can be assigned to a variable and manipulated in certain ways but it cannot be treated as anything other than a piece of (potential) output. In other words, you can&#8217;t re-process it using templates or even explicit iteration. As the name implies, the <code>node-set</code> extension function is used to convert the RTF back into a regular node set which can be <a href="http://www.xml.com/pub/a/2003/12/03/tr.html">used as an intermediate result</a>.</p>

<p>This is an incredibly useful function that probably should have been part of the original XSLT 1.0 language specification. In XSLT 2.0 they acknowledged the usefulness of intermediate results by removing RTFs altogether, and allowing allowing node sets to be created directly within variable declarations.</p>

<p>As you might have guessed, the problem with the <code>node-set</code> extension function is that, well, it&#8217;s an extension of the language. And thus subject to the whims of implementers.</p>

<h4>Best Viewed in Internet Explorer</h4>

<p>OK I&#8217;ll come out and say it. Most of the major browsers support XSLT, but Internet Explorer is the <em>only</em> one that provides the <code>node-set</code> function.</p>

<p>Firefox? They use the Transformiix XSLT engine which doesn&#8217;t provide the function. They&#8217;ve been thinking about it since 2003 and despite <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=193678">having a patch</a> they&#8217;re still thinking. [<strong>Update 31-Jan-2007</strong>: Looks like they've stopped thinking and started committing. <a href="http://www.oreillynet.com/xml/blog/2007/01/limited_exslt_support_in_mozil.htm">Firefox 3.0 is the target.</a> ]</p>

<p>Safari? Same story, although their XSLT engine is <a href="http://xmlsoft.org/XSLT/index.html">libxslt</a> which <a href="http://xmlsoft.org/XSLT/EXSLT/index.html">does</a> support <code>node-set</code> through the EXSLT standard extension library, but the WebKit guys <a href="http://bugzilla.opendarwin.org/show_bug.cgi?id=4079">haven&#8217;t found time to enable it yet</a>.</p>

<p>Opera? <a href="http://www.opera.com/docs/specs/#xml">No XSLT at all</a>. [<strong>Update</strong>: OK Opera 9 has "near complete XSLT". Whether this includes <code>node-set</code> or not, I have no idea. <strong>Further Update</strong>: <a href="http://my.opera.com/desktopteam/blog/show.dml/337199">Yep, it does</a> ]</p>

<p>I&#8217;ve <a href="/archives/2005/10/07/internet-explorer-makes-me/">bagged Internet Explorer in the past</a>, but on this particular (and admittedly fairly esoteric) feature, IE has it all over the competition.</p>

<h4>Working Draft&#8217;s Paradise</h4>

<p>Of course it wouldn&#8217;t be a Microsoft product if there weren&#8217;t some frustrating limitations. Read the <a href="http://www.perfectxml.com/articles/xml/XSLTInMSXML.asp">full details</a> yourself, but as I understand it, the situation is as follows.</p>

<p>Microsoft&#8217;s XML toolkit is called MSXML and in previous releases they implemented an earlier draft of XSLT which is known as WD-xsl (WD for Working Draft). And it really was a draft because the early language bears very little resemblance to XSLT 1.0.</p>

<p>Being conscientious engineers that they are, Microsoft allowed MSXML installations to support both the old WD-xsl and the new XSLT 1.0 stylesheets. So far so good, but unfortunately they did not engineer it to automatically determine which type of stylesheet it was being asked to process. And to maintain compatibility with existing code, the WD-xsl language was chosen as the default.</p>

<div class="aside">
<p>Maybe I should go looking for security vulnerabilities in WD-xsl, which if found might cause Microsoft to remove WD-xsl altogether?</p>
</div>

<p>As a result, Internet Explorer cannot process the standard <code>&lt;?xml-stylesheet href="foo.xsl"?&gt;</code> processing instruction. IE doesn&#8217;t know whether the <code>foo.xsl</code> referred to in this instruction is WD-xsl or XSLT 1.0, and it defaults to the former. In other words they broke an implementation of a standard in favour of an implementation of a draft standard. (Does all this <a href="http://photomatt.net/2006/03/19/invalid-atom/">sound familiar</a>?)</p>

<h4>&#8220;To Help Protect Your Security&#8230;&#8221;</h4>

<p>So besides the standard XML Processing Instruction the next best way to invoke an XSLT 1.0 stylesheet in Internet Explorer is to do so from JavaScript. You do something like:</p>

<pre><code>  function init()
  {
    // load XML source document
    var source = new ActiveXObject("Msxml2.DOMDocument.4.0");
    source.async = false;
    source.load("source.xml");

    // load XSLT stylesheet document
    var stylesheet = new ActiveXObject("Msxml2.DOMDocument.4.0");
    stylesheet.async = false;
    stylesheet.load("stylesheet.xsl");

    // transform the source using the XSLT stylesheet
    target.innerHTML = source.transformNode(stylesheet);
  }
</code></pre>

<p>(Code stolen from <a href="http://www.perfectxml.com/articles/xml/XSLTInMSXML.asp">perfectxml.com article linked above</a>)</p>

<p>Note the use of <code>ActiveXObject</code>. If you try to run this code, IE dutifully warns you about the potential hazards of ActiveX and the need to &#8220;protect your security&#8221; in a yellow  information bar. This is obviously death for websites that want to use XSLT. Bafflingly, it gives you this warning even when you run it locally from your disk.</p>

<p>Of course XSLT scripts are locally-executed and hence potential security hazards, so I don&#8217;t want to trivialise the decisions that Microsoft has made here. But really it shouldn&#8217;t be too hard to secure an XSLT implementation. Besides, JavaScript is far worse &mdash; both in terms of potential for, and history of, security vulnerabilities &mdash; and that isn&#8217;t blocked.</p>

<h4>Whither Browser-based XSLT?</h4>

<p>So the reasons why we don&#8217;t see more XSLT usage in the browser should be obvious. The outlook for the future doesn&#8217;t look too great either.</p>

<p>IMHO the best solution is to charge on with <a href="http://www.xml.com/lpt/a/2002/04/10/xslt2.html">XSLT 2.0</a>. Microsoft have stopped developing MSXML but their .NET replacement is still under development. <a href="http://netapps.muohio.edu/blogs/darcusb/darcusb/archives/2006/06/09/citation-formatting-in-word-2007">Speculation is rife</a> that they may be including XSLT 2.0 support. [<strong>Update</strong>: <a href="http://www.tkachenko.com/blog/archives/000590.html">confirmed</a>] Also there is the Saxon XSLT engine, and early rumblings from the Apache Xalan crowd and Oracle. Although none of these are likely to be used in the browser, they may provide some impetus for XSLT 2.0 as a whole..</p>

<p>Come on Firefox guys, come on WebKit guys, come on Opera guys. XSLT 2.0 looks powerful and useful. Don&#8217;t let Microsoft beat you to the punch &#8211; again.</p>
		        <br clear="left" />
		    </div>
        </div><!-- end post -->

			
<!-- You can start editing here. -->


<div id="comments" class="post">

	<h3 class="comments_headers">3 Comments</h3>

</div>
	
	
			
        <div class="post" id="comment-1435">
		    <div class="metainfo">
                <p>Posted by<br /><a href='http://ussexfree.com' rel='external nofollow' class='url'>Nonecressacheengirl</a><br />
                <input type="hidden" name="post_date" value="Wed, 14 Jun 2006 00:53:00 -0400" />
                <abbr class="commented" title="Wed, 14 Jun 2006 00:53:00 -0400">14 June 2006 @ 12am</abbr><br />
                <a href="#comment-1435">#</a></p>
			</div>
			<div class="content">
				<p><a href=http://ussexfree.com>guy porn star </a> <a href=http://ussexfree.com>porn glossary </a> <a href=http://ussexfree.com>porn fotky </a> <a href=http://ussexfree.com>aniston jennifer porn </a> <a href=http://ussexfree.com>daily free porn video </a> <a href=http://ussexfree.com>like man porn why </a> <a href=http://ussexfree.com>insest mother porn </a> <a href=http://ussexfree.com>gay index porn skin </a> <a href=http://ussexfree.com>king porn </a> <a href=http://ussexfree.com>female in love making male photo porn u </a> <a href=http://ussexfree.com>bitch box porn </a> <a href=http://ussexfree.com>youngest porn star ever </a> <a href=http://ussexfree.com>computer delete file from porn </a> <a href=http://ussexfree.com>clip porn shemale worldwide </a></p> 
							</div>
		<br clear="left" />
		</div>
			
        <div class="post" id="comment-1436">
		    <div class="metainfo">
                <p>Posted by<br /><a href='http://plasmasturm.org/' rel='external nofollow' class='url'>Aristotle Pagaltzis</a><br />
                <input type="hidden" name="post_date" value="Wed, 14 Jun 2006 00:53:00 -0400" />
                <abbr class="commented" title="Wed, 14 Jun 2006 00:53:00 -0400">14 June 2006 @ 12am</abbr><br />
                <a href="#comment-1436">#</a></p>
			</div>
			<div class="content">
				<p>Personally I’d be content to see a fully compliant implementation of XSLT 1.0 with complete EXSLT support.</p> 
							</div>
		<br clear="left" />
		</div>
			
        <div class="post" id="comment-1437">
		    <div class="metainfo">
                <p>Posted by<br />David Carlisle<br />
                <input type="hidden" name="post_date" value="Wed, 14 Jun 2006 00:53:00 -0400" />
                <abbr class="commented" title="Wed, 14 Jun 2006 00:53:00 -0400">14 June 2006 @ 12am</abbr><br />
                <a href="#comment-1437">#</a></p>
			</div>
			<div class="content">
				<p>As a result, Internet Explorer cannot process the standard < ?xml-stylesheet href="foo.xsl"?> processing instruction. IE doesn&#8217;t know whether the foo.xsl referred to in this instruction is WD-xsl or XSLT 1.0, and it defaults to the former.</p>

<p>Not so, IE (from version 6 up) can handle the PI fine (add type=&#8221;text/xsl&#8221;) it uses either xslt or wd-xsl depending on the syntax that it finds, specifically if the xslt namespace is declared in the top level element of the stylesheet.</p> 
							</div>
		<br clear="left" />
		</div>
		
	

	<!-- Comment Form -->

	    

			
				
<div class="posttopline">
	<span class="previous">&larr; <a href="http://girtby.net/archives/2006/06/06/creative-uncommon/" rel="prev">Creative, Uncommon</a></span>
	<span class="next"><a href="http://girtby.net/archives/2006/06/24/bad-company/" rel="next">Bad Company</a> &rarr;</span>
</div>

<br clear="all" />

    <div class="footer">
		
        <div class="first">
        <div id="text-318154731" class="widget widget_text"><h5 class="widgettitle">Archives</h5>			<div class="textwidget"><ul>
<li><a href="/archives/2009">2009</a></li>
<li><a href="/archives/2008">2008</a></li>
<li><a href="/archives/2007">2007</a></li>
<li><a href="/archives/2006">2006</a></li>
<li><a href="/archives/2005">2005</a></li>
<li><a href="/archives/2004">2004</a></li>
</ul></div>
		</div>		</div>

        <div class="sidebar">
        <div id="text-326846052" class="widget widget_text"><h5 class="widgettitle">Leveraged Synergy</h5>			<div class="textwidget"><p>Hello, I&#8217;m Alastair Rankine. I once had a blog, and you've found it. <a href="/about/">Would you like to know more?</a></p>
<p>From time to time I made offerings to the internet. <a href="/offerings/">Would you like some?</a></p>
</div>
		</div>        </div>

        <div class="last">
        <div id="linkcat-2" class="widget widget_links"><h5 class="widgettitle">Blogroll</h5>
	<ul class='xoxo blogroll'>
<li><a href="http://bjkeefe.blogspot.com">bjkeefe</a></li>
<li><a href="http://brainsnorkel.com">brainsnorkel</a></li>
<li><a href="http://deadlybloodyserious.com">Deadly Bloody Serious</a></li>
<li><a href="http://blog.alphajuliet.com/">follicle</a></li>
<li><a href="http://madbean.com/">madbean</a></li>
<li><a href="http://marxyblog.blogspot.com">marxy&#8217;s musing on technology</a></li>
<li><a href="http://mattrubinstein.com.au">mattrubinstein.com.au</a></li>
<li><a href="http://somethinkodd.com/oddthinking">OddThinking</a></li>

	</ul>
</div>
        </div>

	    </div><!-- end footer -->

        <br clear="all" />
        
		<div class="copyright">
        	        	<span class="previous">&larr; <a href="http://girtby.net">Back to Home</a></span>
                        <p>Powered by <a href="http://wordpress.org">WordPress</a> using the <a href="http://powazek.com/posts/516">DePo Clean Theme</a> <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/au/"><img alt="Creative Commons License" class="badge" width=80 height=15 src="http://i.creativecommons.org/l/by-sa/2.5/au/80x15.png" /></a></p>
            		</div>

	</div> <!-- end container -->
</body>
</html>
