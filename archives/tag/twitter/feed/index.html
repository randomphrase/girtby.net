<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>girtby.net &#187; twitter</title>
	<atom:link href="http://girtby.net/archives/tag/twitter/feed/" rel="self" type="application/rss+xml" />
	<link>http://girtby.net</link>
	<description>this blog is girtby.net</description>
	<lastBuildDate>Thu, 17 Sep 2009 14:27:44 +0000</lastBuildDate>
	<generator>http://wordpress.org/?v=2.9-rare</generator>
	<language>en</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
			<item>
		<title>Archiving Tweets</title>
		<link>http://girtby.net/archives/2009/08/23/archiving-tweets/</link>
		<comments>http://girtby.net/archives/2009/08/23/archiving-tweets/#comments</comments>
		<pubDate>Sun, 23 Aug 2009 12:14:05 +0000</pubDate>
		<dc:creator>alastair</dc:creator>
				<category><![CDATA[Nerd Factor X]]></category>
		<category><![CDATA[archive]]></category>
		<category><![CDATA[backup]]></category>
		<category><![CDATA[twitter]]></category>

		<guid isPermaLink="false">http://girtby.net/?p=3905</guid>
		<description><![CDATA[If you&#8217;ve run Damon Cortesi&#8217;s handy curl command to download all (or the last 3200) tweets from your twitter account, you&#8217;ll have a directory full of files with names like user_timeline.xml?count=100&#38;page=1. Not only that but they include a large amount of redundant profile stuff in the &#60;user&#62; element. And not only that, but twitter sometimes [...]]]></description>
			<content:encoded><![CDATA[<p>If you&#8217;ve run <a href="http://dcortesi.com/2009/07/16/for-wil-wheaton/">Damon Cortesi&#8217;s handy curl command</a> to download all (or the last 3200) tweets from your twitter account, you&#8217;ll have a directory full of files with names like <code>user_timeline.xml?count=100&amp;page=1</code>. Not only that but they include a large amount of redundant profile stuff in the <code>&lt;user&gt;</code> element. And not only <em>that</em>, but twitter sometimes returns a &#8220;Twitter is over capacity&#8221; page instead of your tweets.</p>

<p>What we want to do is a) detect any files which don&#8217;t contain tweets, b) remove the redundant user profile, and c) combine the results into a single file.</p>

<p>Well, friends, here is a shell script to do exactly that. You&#8217;ll need zsh and xsltproc, both of which are standard on MacOS X and most sane Linuxen.</p>

<div class="aside"><p>zsh is needed to sort the input files in numeric, as opposed to lexicographic, order. If you know of a way to do this in bash, let me know&#8230;</p></div>

<p>Output is on stdout, so just redirect to your filename of choice:</p>

<pre><code>$ tweetcombine user_timeline.xml\?count=100\&amp;page=* \
    &gt; tweet_archive.xml
</code></pre>

<p><span id="more-3905"></span>Here&#8217;s the script:</p>

<pre><code>#!/bin/zsh

# Combine all of the twitter user_timeline.xml files specified on the command line into a single output
# Written by Alastair Rankine, http://girtby.net
# Licensed as Creative Commons BY-SA

input_args=()
for f in ${(on)*}; do
    [[ -f $f ]] || exit "Not a file: $f"
    input_args+="&lt;input&gt;${f//&amp;/&amp;amp;}&lt;/input&gt;"
done

xsltproc - &lt;&lt;EOF
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE inputs [
  &lt;!ATTLIST xsl:stylesheet id ID #REQUIRED&gt;
]&gt;
&lt;?xml-stylesheet type="text/xml" href="#style1"?&gt;
&lt;inputs&gt;
  ${input_args}

  &lt;xsl:stylesheet id="style1" version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

    &lt;xsl:output type="xml" indent="yes"/&gt;

    &lt;xsl:template match="*"&gt;
      &lt;xsl:copy&gt;
        &lt;xsl:copy-of select="@*"/&gt;
        &lt;xsl:apply-templates/&gt;
      &lt;/xsl:copy&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="statuses"&gt;
      &lt;xsl:apply-templates/&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="user"/&gt;

    &lt;xsl:template match="xsl:stylesheet"/&gt;

    &lt;xsl:template match="input"&gt;
      &lt;xsl:choose&gt;
        &lt;xsl:when test="document(.)/statuses"&gt;
          &lt;xsl:apply-templates select="document(.)"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;xsl:message terminate="yes"&gt;&lt;xsl:value-of select="."/&gt; does not contain statuses element&lt;/xsl:message&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
    &lt;/xsl:template&gt;

    &lt;xsl:template match="inputs"&gt;
      &lt;statuses type="array"&gt;
        &lt;xsl:apply-templates/&gt;
      &lt;/statuses&gt;
    &lt;/xsl:template&gt;

  &lt;/xsl:stylesheet&gt;
&lt;/inputs&gt;
EOF
</code></pre>

<p>I think this method of sticking filename arguments into an XSL document with an embedded stylesheet is quite a powerful way of processing XML documents with shell scripts. (Probably should put the <code>&lt;input&gt;</code> tags into a separate namespace though&#8230;)</p>
]]></content:encoded>
			<wfw:commentRss>http://girtby.net/archives/2009/08/23/archiving-tweets/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Twitter over IP</title>
		<link>http://girtby.net/archives/2008/06/04/twitter-over-ip/</link>
		<comments>http://girtby.net/archives/2008/06/04/twitter-over-ip/#comments</comments>
		<pubDate>Wed, 04 Jun 2008 10:43:00 +0000</pubDate>
		<dc:creator>alastair</dc:creator>
				<category><![CDATA[Linkpimpin']]></category>
		<category><![CDATA[Nerd Factor X]]></category>
		<category><![CDATA[architecture]]></category>
		<category><![CDATA[end-to-end]]></category>
		<category><![CDATA[network]]></category>
		<category><![CDATA[twitter]]></category>

		<guid isPermaLink="false">http://girtby.net/2008/06/04/twitter-over-ip</guid>
		<description><![CDATA[Let&#8217;s solve Twitter&#8217;s scalability problems, shall we?

So, like most people, I don&#8217;t know much about the problems there and certainly don&#8217;t have any solutions to suggest. But I do know there are a certain class of solutions which aren&#8217;t on the table.

If you look at Twitter from a suitably high vantage point you see real-time [...]]]></description>
			<content:encoded><![CDATA[<p>Let&#8217;s solve Twitter&#8217;s scalability problems, shall we?</p>

<p>So, like most people, I don&#8217;t know much about the problems there and certainly don&#8217;t have any solutions to suggest. But I do know there are a certain class of solutions which <em>aren&#8217;t</em> on the table.</p>

<p>If you look at Twitter from a suitably high vantage point you see real-time communication between small groups. People entering short messages and having these messages appear at their peers a small time later. There&#8217;s also a central archive, but I&#8217;ve heard Twitter described as &#8220;public Instant-Messaging&#8221; and this seems to characterise it best for me.</p>

<p>In short, Twitter seems more suited to peer-to-peer communication than to client-server. What sort of protocol would it use? I can imagine a protocol which would be probably UDP-based, and which would send tweets to followers either directly from peers or perhaps through a local aggregation point. Large groups of followers could perhaps even use UDP multicast. Archive servers could be reached through network anycast addresses, to allow for greater decentralisation. IPv6 to get universal connectivity. And so on; fill in your own pet network technology here, there are certainly lots of potential solutions.</p>

<p>Instead of these, clients communicate directly with the Twitter servers using HTTP. Not only that, but they <em>poll</em> for updates. Bit of an architectural blunder, you might think. Well not really. In fact I don&#8217;t think the Twitter designers had any choice.</p>

<p>Once upon a time it was possible to deploy new application-layer protocols on the Internet. But those times have passed, it seems. These days, it&#8217;s HTTP(S) or nothing. And this is <em>not</em> the protocol you would choose for carrying tweets, if you had the choice. So the fact that twitter works <em>at all</em> over this sub-optimal application-layer protocol is quite an achievement.</p>

<p>This is a great example of the many ways in which <a href="/archives/2006/01/04/making-connections/">innovation can be stifled</a> by enforcing a lowest-common-denominator.</p>

<p>The impact is of course more widespread than just Twitter. In fact, the so-called end-to-end principle which was one of the fundamental founding principles of the Internet is now all but abandoned in practice. Geoff Huston examines the issue in some detail in a <a href="http://www.potaroo.net/ispcol/2008-05/eoe2e.html">recent article</a>, and it is highly recommended.</p>

<p>Of course, there are no easy answers, either for Twitter or the next application to suffer due to the proliferation of network middleware. But it&#8217;s certainly an issue that does need to be more prominent.</p>

<p>(This post is an obvious departure from my usual style of blatant attack pieces in order to score traffic and fame for myself. Normal service will resume shortly.)</p>
]]></content:encoded>
			<wfw:commentRss>http://girtby.net/archives/2008/06/04/twitter-over-ip/feed/</wfw:commentRss>
		<slash:comments>8</slash:comments>
		</item>
	</channel>
</rss>
