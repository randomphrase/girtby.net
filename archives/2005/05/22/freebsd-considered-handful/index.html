<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>girtby.net &#8211;   FreeBSD considered handful</title>

<meta name="verify-v1" content="unGvQ7Jwj5liZb2PzH2ckduvpe8Ua3Ls0MONzCHQQn4=" />

<link rel="stylesheet" href="http://girtby.net/wp-content/themes/depo-clean/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Articles Feed" href="http://girtby.net/feed/atom/" />
<link rel="alternate" type="application/atom+xml" title="girtby.net Comments Feed" href="http://girtby.net/comments/feed/atom/" />

<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://arankine.myopenid.com/" />

<link rel="meta" href="http://girtby.net/labels.rdf" type="application/rdf+xml" title="ICRA labels" />
<meta http-equiv="pics-Label" content='(pics-1.1 "http://www.icra.org/pics/vocabularyv03/" l gen true for "http://girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1) gen true for "http://www.girtby.net" r (n 0 s 0 v 0 l 2 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 1))' />

<link rel="prev" href="http://girtby.net/archives/2005/05/19/more-powerpoint-ui-potshots/" />
<link rel="next" href="http://girtby.net/archives/2005/05/23/whats-in-your-bookmarks-bar/" />

<link rel="pingback" href="http://girtby.net/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Feed" href="http://girtby.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; Comments Feed" href="http://girtby.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="girtby.net &raquo; FreeBSD considered handful Comments Feed" href="http://girtby.net/archives/2005/05/22/freebsd-considered-handful/feed/" />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'></script>
<script type='text/javascript' src='http://girtby.net/wp-content/themes/depo-clean/javascript/friendly_dates.js?ver=2.9-rare'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://girtby.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://girtby.net/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='girtby.net' href='http://girtby.net' />
<link rel='start' title='Thunderbirds Are Go-ne' href='http://girtby.net/archives/2004/09/20/thunderbirds-are-go-ne/' />
<link rel='prev' title='More PowerPoint UI Potshots' href='http://girtby.net/archives/2005/05/19/more-powerpoint-ui-potshots/' />
<link rel='next' title='What&#8217;s in your bookmarks bar?' href='http://girtby.net/archives/2005/05/23/whats-in-your-bookmarks-bar/' />
<meta name="generator" content="WordPress 2.9-rare" />
<link rel='canonical' href='http://girtby.net/archives/2005/05/22/freebsd-considered-handful/' />
			<script type="text/javascript" src="http://girtby.net/wp-content/plugins/flickr-tag/js/flickrTagTooltips.js"></script>

			<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTagTooltips.css" type="text/css" rel="stylesheet"/>
	
		<link href="http://girtby.net/wp-content/plugins/flickr-tag/css/flickrTag.css" type="text/css" rel="stylesheet"/>
	</head>
<body>
<div class="container">
	<div class="header">
        <div class="search">
            <form method="get" id="sform" action="http://girtby.net/">
                <input type="text" id="q" value="" name="s" size="15" />
			</form>
        </div><!-- end search -->
        			        <h1><a href="http://girtby.net/">this blog is girtby.net</a> 
            </h1>
	</div><!-- end header -->


<div class="blogads">

<!-- Your Stuff Here -->

</div>


    						
      <div class="post">
          <div class="metainfo">
              <p>Posted<br />
                <abbr class="published" title="Sun, 22 May 2005 15:27:59 -0400">22 May 2005 @ 3pm</abbr></p>
                <p>Tagged<br />
                <a href="http://girtby.net/archives/category/nerd-factor-x/" title="View all posts in Nerd Factor X" rel="category tag">Nerd Factor X</a></p>
                		    </div>
		    <div class="content">
		        <h3>FreeBSD considered handful 
		        </h3>
		        <p>Like most geeks I have a server at home for doing serveral tasks. Today I upgraded it from FreeBSD 5.2.1 to 5.4. This was a slightly daunting experience, which I will now recite.</p>

<p><span id="more-100"></span></p>

<p>My server PC is an HP Kayak which, given its 4 GB Ultra-Wide SCSI disk, was probably The Shit back in The Day. The mighty 333MHz Pentium 2 doesn&#8217;t really cut it any more for interactive use, but as a mostly I/O-bound server it suffices. For many years now I have been relying on FreeBSD as the operating system for this box (or its predecessors). I have tried others (NetBSD, Linux) but come back to <a href="http://www.freebsd.org">FreeBSD</a> for many reasons.</p>

<p>One of the things you can&#8217;t say about FreeBSD is that it has a great installer. The mysteries of the FreeBSD installer have yet to reveal themselves to me, so I had been procrastinating on upgrading it, hence the 5.3 release passed me by.</p>

<p>One of the problems with my server is that the CD-ROM drive seems to be non-responsive. Both the OS and the BIOS see it, but it doesn&#8217;t seem to read disks. For ordinary operating systems this might be a problem, but not FreeBSD. The installer fits onto three floppies, and once it is running it can download the remainder of the OS installation from a nearby FTP site.</p>

<p>So far no problems, except that something went wrong upgrading the <code>/etc</code> directory. For some unknown reason it left me with a half-upgraded <code>/etc</code>. Booting into the new OS, there are a <em>lot</em> of error messages, but at least it gives me a login prompt so I go to work fixing.</p>

<p>Firstly the user database had reverted back to the default one, so I had to log in as root (no password!). Turns out that there is a copy of my old <code>/etc</code> directory in <code>/tmp</code>, so I reinstate the <code>passwd</code> file and friends, to give me back my user accounts. Similar procedure for groups.</p>

<p>Next up, address some of the error messages on startup. These occur mostly as the system is working it&#8217;s way through the <code>/etc/rc</code> files to start services. Many of them were like: <code>WARNING: $flushroutes is not configured - RTFM! That's rc.conf(5) you idiot!</code> (I&#8217;m paraphrasing).</p>

<p>This one is a little trickier. Googling on the actual error message is helpful, but the suggested solution isn&#8217;t, at least not immediately. There&#8217;s a <code>mergemaster</code> tool designed specifically for updating your <code>/etc</code> directory during OS upgrades &mdash; the name comes from the fact that the new files are merged into your current ones &mdash; but it doesn&#8217;t work with binary upgrades, instead it is designed for those who have built their OS from source (as you do).</p>

<p>Nevertheless I was able to go through a <a href="http://somethinkodd.com/oddthinking/?p=20">trial-and-error</a> problem-solving process of installing new source distribution packages into <code>/usr/src</code>, re-running mergemaster and seeing what breaks. Eventually I was able to get it to run, and fix up my <code>/etc</code> directory. Hooray.</p>

<p>Well mostly fix up anyway. There were a few leftover problems, at least partly due to the fact that I had some ports (i.e. software outside of the core OS) installed that had migrated into the base OS in the new release. So this was a matter of removing my ports and migrating the config files across to use the built-in OS software.</p>

<p>Lastly, and here&#8217;s the really nice part, I was able to verify that I hadn&#8217;t totally screwed up everything.</p>

<p>There&#8217;s a port (why this isn&#8217;t part of the core OS I have no idea) called <a href="http://www.daemonology.net/freebsd-update/">freebsd-update</a>. Guess what it does? No, it won&#8217;t do major OS upgrades, but it will check to see if there are updated versions of any of your installed OS software available. Kinda like Windows Update.</p>

<p>But in addition to this, FreeBSD-update also has an <abbr title="Intrusion Detection System">IDS</abbr> mode. When used in this mode, it computes a hash of all of your currently installed software and compares it against a reference for the specific version of the OS you&#8217;re running! Great stuff, and it confirmed that I hadn&#8217;t selected the games package during the upgrade. Other than that, it seemed to be telling me that the upgrade was a success. Whew!</p>

<p><a href="/archives/2005/02/01/been-caught-stealin-focus/">Tradition</a> <a href="/archives/2005/03/17/dont-use-wingdings/">dictates</a> <a href="/archives/2005/03/31/what-does-this-button-do">that</a> I must now compare this experience to the MacOS X equivalent. Operating systems are in general notoriously difficult to upgrade, and MacOS X isn&#8217;t immune to upgrade problems. Check out <a href="http://weblog.infoworld.com/yager/2005/05/09.html#a52">Tom Yeager&#8217;s Tiger upgrade story</a> for an example of how badly it can go. Tim Bray has <a href="http://www.tbray.org/ongoing/When/200x/2005/05/21/OSS-Hell">minor hassles</a>. However, my own migration to Tiger (not strictly an upgrade because of new hardware) went flawlessly. YMMV.</p>
		        <br clear="left" />
		    </div>
        </div><!-- end post -->

			
<!-- You can start editing here. -->


<div id="comments" class="post">

	<h3 class="comments_headers">1 Comment</h3>

</div>
	
	
			
        <div class="post" id="comment-1135">
		    <div class="metainfo">
                <p>Posted by<br />cmb<br />
                <input type="hidden" name="post_date" value="Sun, 22 May 2005 15:27:59 -0400" />
                <abbr class="commented" title="Sun, 22 May 2005 15:27:59 -0400">22 May 2005 @ 3pm</abbr><br />
                <a href="#comment-1135">#</a></p>
			</div>
			<div class="content">
				<p>I wouldn&#8217;t do an upgrade with the CD or floppies.  Using cvsup and doing a buildworld/kernel and mergemaster is a lot easier, and won&#8217;t overwrite your passwd file.  I&#8217;ve upgrading a ton of systems in this fashion, and it &#8220;just works&#8221;.</p>

<p>Richard Bejtlich&#8217;s Keeping FreeBSD Up To Date article explains this process better than anything else I&#8217;ve seen.  <a href="http://www.taosecurity.com/keeping" rel="nofollow">http://www.taosecurity.com/keeping</a><em>freebsd</em>up-to-date.html</p> 
							</div>
		<br clear="left" />
		</div>
		
	

	<!-- Comment Form -->

	    

			
				
<div class="posttopline">
	<span class="previous">&larr; <a href="http://girtby.net/archives/2005/05/19/more-powerpoint-ui-potshots/" rel="prev">More PowerPoint UI Potshots</a></span>
	<span class="next"><a href="http://girtby.net/archives/2005/05/23/whats-in-your-bookmarks-bar/" rel="next">What&#8217;s in your bookmarks bar?</a> &rarr;</span>
</div>

<br clear="all" />

    <div class="footer">
		
        <div class="first">
        <div id="text-318154731" class="widget widget_text"><h5 class="widgettitle">Archives</h5>			<div class="textwidget"><ul>
<li><a href="/archives/2009">2009</a></li>
<li><a href="/archives/2008">2008</a></li>
<li><a href="/archives/2007">2007</a></li>
<li><a href="/archives/2006">2006</a></li>
<li><a href="/archives/2005">2005</a></li>
<li><a href="/archives/2004">2004</a></li>
</ul></div>
		</div>		</div>

        <div class="sidebar">
        <div id="text-326846052" class="widget widget_text"><h5 class="widgettitle">Leveraged Synergy</h5>			<div class="textwidget"><p>Hello, I&#8217;m Alastair Rankine. I once had a blog, and you've found it. <a href="/about/">Would you like to know more?</a></p>
<p>From time to time I made offerings to the internet. <a href="/offerings/">Would you like some?</a></p>
</div>
		</div>        </div>

        <div class="last">
        <div id="linkcat-2" class="widget widget_links"><h5 class="widgettitle">Blogroll</h5>
	<ul class='xoxo blogroll'>
<li><a href="http://bjkeefe.blogspot.com">bjkeefe</a></li>
<li><a href="http://brainsnorkel.com">brainsnorkel</a></li>
<li><a href="http://deadlybloodyserious.com">Deadly Bloody Serious</a></li>
<li><a href="http://blog.alphajuliet.com/">follicle</a></li>
<li><a href="http://madbean.com/">madbean</a></li>
<li><a href="http://marxyblog.blogspot.com">marxy&#8217;s musing on technology</a></li>
<li><a href="http://mattrubinstein.com.au">mattrubinstein.com.au</a></li>
<li><a href="http://somethinkodd.com/oddthinking">OddThinking</a></li>

	</ul>
</div>
        </div>

	    </div><!-- end footer -->

        <br clear="all" />
        
		<div class="copyright">
        	        	<span class="previous">&larr; <a href="http://girtby.net">Back to Home</a></span>
                        <p>Powered by <a href="http://wordpress.org">WordPress</a> using the <a href="http://powazek.com/posts/516">DePo Clean Theme</a> <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.5/au/"><img alt="Creative Commons License" class="badge" width=80 height=15 src="http://i.creativecommons.org/l/by-sa/2.5/au/80x15.png" /></a></p>
            		</div>

	</div> <!-- end container -->
</body>
</html>
